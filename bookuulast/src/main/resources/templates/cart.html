<!doctype html>
<html class="no-js" lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Koparion – Book Shop Bootstrap 4 Template</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Favicon -->
		<link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">

		<!-- all css here -->
		<!-- bootstrap v3.3.6 css -->
        <link rel="stylesheet" href="css/bootstrap.min.css">
		<!-- animate css -->
        <link rel="stylesheet" href="css/animate.css">
		<!-- meanmenu css -->
        <link rel="stylesheet" href="css/meanmenu.min.css">
		<!-- owl.carousel css -->
        <link rel="stylesheet" href="css/owl.carousel.css">
		<!-- font-awesome css -->
        <link rel="stylesheet" href="css/font-awesome.min.css">
		<!-- flexslider.css-->
        <link rel="stylesheet" href="css/flexslider.css">
		<!-- chosen.min.css-->
        <link rel="stylesheet" href="css/chosen.min.css">
		<!-- style css -->
		<link rel="stylesheet" href="style.css">
		<!-- responsive css -->
        <link rel="stylesheet" href="css/responsive.css">
		<!-- modernizr css -->
        <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    </head>
    <body class="cart">


        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <!-- header-area-start -->
        <header>
            <!-- header-top-area-start -->
            <div class="header-top-area">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                            <div class="language-area">
                                <ul>
                                    <li><img src="img/flag/1.jpg" alt="flag" /><a href="#">English<i class="fa fa-angle-down"></i></a>
                                        <div class="header-sub">
                                            <ul>
                                                <li><a href="#"><img src="img/flag/2.jpg" alt="flag" />france</a></li>
                                                <li><a href="#"><img src="img/flag/3.jpg" alt="flag" />croatia</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                    <li><a href="#">USD $<i class="fa fa-angle-down"></i></a>
                                        <div class="header-sub dolor">
                                            <ul>
                                                <li><a href="#">EUR €</a></li>
                                                <li><a href="#">USD $</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                            <div class="account-area text-right">
                                <div th:if="${session.user eq null}">
                                    <ul>
                                        <li><a href="register.html">注册</a></li>
                                        <li><a href="login.html"><span>登录</span></a></li>
                                    </ul>
                                </div>
                                <div class="account-area text-right">
                                    <div th:if="${session.user} ne null">
                                        <ul>
                                            <li><a href="/checkout.html">我的信息</a></li>
                                            <li><a href="login.html"><span th:text="${session.user.getUsername()}"></span></a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- header-top-area-end -->
                <!-- header-mid-area-start -->
                <div class="header-mid-area ptb-40">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-3 col-md-3 col-sm-5 col-xs-12">
                                <div class="header-search">
                                    <form action="/seachBooks">
                                        <input type="text" name="bookName" placeholder="搜索图书" />
                                        <input type="submit" value="搜索图书">
                                    </form>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-4 col-xs-12">
                                <div class="logo-area text-center logo-xs-mrg">
                                    <a href="main.html"><img src="img/logo/logo.png" alt="logo" /></a>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12" th:if="${session.user} ne null">
                                <div class="my-cart">
                                    <ul>
                                        <li><a href="/getCart"><i class="fa fa-shopping-cart"></i>我的购物车</a>
                                            <span th:text="${session.size}"></span>
                                            <div class="mini-cart-sub">
                                                <div class="cart-product">
                                                    <div class="single-cart" th:each="cart:${session.bookCarts}">
                                                        <div class="cart-img">
                                                            <a th:href="'/book?bookname='+${cart.get('bookName')}"><img th:src="${cart.get('bookImage')}" alt="book" /></a>
                                                        </div>
                                                        <div class="cart-info">
                                                            <h5><a class="bookName" th:href="'/book?bookname='+${cart.get('bookName')}" th:text="${cart.get('bookName')}"></a></h5>
                                                            <p th:text="${cart.get('bookNumber')}+'*'+${cart.get('bookPrice')}"></p>
                                                        </div>
                                                        <div class="cart-icon">
                                                            <a class="delBook"><i class="fa fa-remove"></i></a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="cart-totals">
                                                    <h5>总价 <span th:text="'$'+${session.number}"></span></h5>
                                                </div>
                                                <div class="cart-bottom">
                                                    <a class="view-cart" href="/getCart">查看购物车</a>
                                                    <!--                                                    <a href="checkout.html">Check out</a>-->
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- header-mid-area-end -->
                <!-- main-menu-area-start -->
                <div class="main-menu-area hidden-sm hidden-xs sticky-header-1" id="header-sticky">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="menu-area">
                                    <nav>
                                        <ul>
                                            <li class="active"><a th:href="@{/}">主页</a></li>
                                            <li><a th:href="@{/shop}">书</a></li>
                                            <li><a href="product-details.html">有声读物</a></li>
                                            <li><a href="product-details.html">儿童读物</a></li>
                                        </ul>
                                    </nav>
                                </div>
                                <div class="safe-area">
                                    <a th:href="@{/exit}">退出</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- main-menu-area-end -->
                <!-- mobile-menu-area-start -->
                <div class="mobile-menu-area hidden-md hidden-lg">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="mobile-menu">
                                    <nav id="mobile-menu-active">
                                        <ul id="nav">
                                            <li class="active"><a th:href="@{/}">主页</a></li>
                                            <li><a th:href="@{/shop}">书</a></li>
                                            <li><a href="product-details.html">有声读物</a></li>
                                            <li><a href="product-details.html">儿童读物</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- mobile-menu-area-end -->
        </header>
        <!-- header-area-end -->
		<!-- breadcrumbs-area-start -->
		<div class="breadcrumbs-area mb-70">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<div class="breadcrumbs-menu">
							<ul>
								<li><a href="/">Home</a></li>
								<li><a href="/getCart" class="active">cart</a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- breadcrumbs-area-end -->
		<!-- entry-header-area-start -->
		<div class="entry-header-area">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<div class="entry-header-title">
							<h2>Cart</h2>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- entry-header-area-end -->
		<!-- cart-main-area-start -->
		<div class="cart-main-area mb-70">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<form action="#">
							<div class="table-content table-responsive">
								<table id="books">
									<thead>
										<tr>
											<th class="product-thumbnail">图片</th>
											<th class="product-name">商品</th>
											<th class="product-price">单价</th>
											<th class="product-quantity">数量</th>
											<th class="product-subtotal">总价</th>
											<th class="product-remove">删除</th>
										</tr>
									</thead>
									<tbody th:each="cart:${bookCarts}">
										<tr>
											<td class="product-thumbnail"><a th:href="'/book?bookname='+${cart.get('bookName')}"><img th:src="${cart.get('bookImage')}" alt="man" /></a></td>
											<td class="product-name"><a class="bookName" th:href="'/book?bookname='+${cart.get('bookName')}" th:text="${cart.get('bookName')}"></a></td>
											<td class="product-price"><span class="amount">$</span> <span class="bookPrice" th:text="${cart.get('bookPrice')}"></span></td>
                                            <td class="product-quantity"><input class="number" type="number" th:value="${cart.get('bookNumber')}"/></td>
											<td class="product-subtotal" ><span>$</span><span class="total" th:text="${cart.get('bookPrice')}*${cart.get('bookNumber')}"></span></td>
											<td class="product-remove"><a class="delCart"><i class="fa fa-times"></i></a></td>
										</tr>
									</tbody>
								</table>
							</div>
						</form>
					</div>
				</div>
				<div class="row">
                    <div class="col-lg-8 col-md-8 col-sm-6 col-xs-12">
                        <div class="buttons-cart mb-30">
                            <ul>
                                <li><a href="#">更新购物车</a></li>
                                <li><a href="/shop">继续购物</a></li>
                            </ul>
                        </div>
                        <div class="coupon">
                            <h3>优惠卷</h3>
                            <p>输入优惠券代码</p>
                            <form action="#">
                                <input type="text" placeholder="Coupon code">
                                <a href="#">申请优惠券</a>
                            </form>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
                        <div class="cart_totals">
                            <h2>购物车总和</h2>
                            <br>
                            <table>
                                <tbody>

                                    <tr class="shipping">
                                        <th>运费</th>
                                        <td>
                                            <ul id="shipping_method">
                                                <li>
                                                    <label> 免费送货 </label>
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="order-total">
                                        <th>总价</th>
                                        <td>
                                            <strong>
                                               <span class="amount">$</span> <span  id="totalPrice" class="amount" th:text="${number}"></span>
                                            </strong>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <br>
                            <div class="wc-proceed-to-checkout">
                                <a id="goali">支付</a>
                            </div>
                        </div>
                    </div>
                </div>
			</div>
		</div>
		<!-- cart-main-area-end -->
		<!-- footer-area-start -->
		<footer>
			<!-- footer-top-start -->
			<div class="footer-top">
				<div class="container">
					<div class="row">
						<div class="col-lg-12">
							<div class="footer-top-menu bb-2">
								<nav>
									<ul>
										<li><a href="#">home</a></li>
										<li><a href="#">Enable Cookies</a></li>
										<li><a href="#">Privacy and Cookie Policy</a></li>
										<li><a href="#">contact us</a></li>
										<li><a href="#">blog</a></li>
									</ul>
								</nav>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- footer-top-start -->
			<!-- footer-mid-start -->
			<div class="footer-mid ptb-50">
				<div class="container">
					<div class="row">
				        <div class="col-lg-8 col-md-8 col-sm-12">
				            <div class="row">
				                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                    <div class="single-footer br-2 xs-mb">
                                        <div class="footer-title mb-20">
                                            <h3>Products</h3>
                                        </div>
                                        <div class="footer-mid-menu">
                                            <ul>
                                                <li><a href="about.html">About us</a></li>
                                                <li><a href="#">Prices drop </a></li>
                                                <li><a href="#">New products</a></li>
                                                <li><a href="#">Best sales</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                    <div class="single-footer br-2 xs-mb">
                                        <div class="footer-title mb-20">
                                            <h3>Our company</h3>
                                        </div>
                                        <div class="footer-mid-menu">
                                            <ul>
                                                <li><a href="contact.html">Contact us</a></li>
                                                <li><a href="#">Sitemap</a></li>
                                                <li><a href="#">Stores</a></li>
                                                <li><a href="register.html">My account </a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                    <div class="single-footer br-2 xs-mb">
                                        <div class="footer-title mb-20">
                                            <h3>Your account</h3>
                                        </div>
                                        <div class="footer-mid-menu">
                                            <ul>
                                                <li><a href="contact.html">Addresses</a></li>
                                                <li><a href="#">Credit slips </a></li>
                                                <li><a href="#"> Orders</a></li>
                                                <li><a href="#">Personal info</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
				            </div>
				        </div>
				        <div class="col-lg-4 col-md-4 col-sm-12">
                            <div class="single-footer mrg-sm">
                                <div class="footer-title mb-20">
                                    <h3>STORE INFORMATION</h3>
                                </div>
                                <div class="footer-contact">
                                    <p class="adress">
                                        <span>My Company</span>
                                        42 avenue des Champs Elysées 75000 Paris France
                                    </p>
                                    <p><span>Call us now:</span> (+1)866-540-3229</p>
                                    <p><span>Email:</span>  support@hastech.com</p>
                                </div>
                            </div>
				        </div>
					</div>
				</div>
			</div>
			<!-- footer-mid-end -->
			<!-- footer-bottom-start -->
			<div class="footer-bottom">
				<div class="container">
					<div class="row bt-2">
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<div class="copy-right-area">
								<p>Copyright ©<a href="http://www.bootstrapmb.com/">Koparion</a>. All Right Reserved.</p>
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
							<div class="payment-img text-right">
								<a href="#"><img src="img/1.png" alt="payment" /></a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- footer-bottom-end -->
		</footer>
		<!-- footer-area-end -->
		
		
		<!-- all js here -->
		<!-- jquery latest version -->
        <script src="js/vendor/jquery-1.12.0.min.js"></script>
		<!-- bootstrap js -->
        <script src="js/bootstrap.min.js"></script>
		<!-- owl.carousel js -->
        <script src="js/owl.carousel.min.js"></script>
		<!-- meanmenu js -->
        <script src="js/jquery.meanmenu.js"></script>
		<!-- wow js -->
        <script src="js/wow.min.js"></script>
		<!-- jquery.parallax-1.1.3.js -->
        <script src="js/jquery.parallax-1.1.3.js"></script>
		<!-- jquery.countdown.min.js -->
        <script src="js/jquery.countdown.min.js"></script>
		<!-- jquery.flexslider.js -->
        <script src="js/jquery.flexslider.js"></script>
		<!-- chosen.jquery.min.js -->
        <script src="js/chosen.jquery.min.js"></script>
		<!-- jquery.counterup.min.js -->
        <script src="js/jquery.counterup.min.js"></script>
		<!-- waypoints.min.js -->
        <script src="js/waypoints.min.js"></script>
		<!-- plugins js -->
        <script src="js/plugins.js"></script>
		<!-- main js -->
        <script src="js/main.js"></script>
    </body>
    <script>
        var bookName;
        $('.single-cart').click(function () {
            bookName =$(this).find('.bookName').text()
            console.log(bookName)
        })
        $('.delBook').click(function () {
            $.ajax({
                type:"get",
                url:"/delCart",
                data:{"bookName":bookName},
                success:function (data) {
                    alert(data)
                }
            })
        })
    </script>

    <script>
        $('.delCart').click(function () {
            bookName= $(this).parent('td').parent('tr').find('.bookName').text()
            $.ajax({
                type:"get",
                url:"/delCart",
                data:{"bookName":bookName},
                success:function (data) {
                    alert(data)
                }
            })
        })
    </script>

    <script>
        var totalPrice=0
       $('.number').click(function () {
           var number=$('.number').val()
           if (number<=0){
               alert('商品数量不能为0')
               $('.number').val(1)
           }
          var bookPrice= parseInt($(this).parent('td').parent('tr').find('.bookPrice').text())
           var bookNumber= parseInt($(this).parent('td').parent('tr').find('.number').val())
           $(this).parent('td').parent('tr').find('.total').text(bookNumber*bookPrice)
           $('#books').find('tbody').each(function () {
               var Price= parseInt($(this).find('tr').find('td').find('.total').text())
               totalPrice +=Price;
           })
           $('#totalPrice').text(totalPrice);
           totalPrice=0
       })

    </script>

    <script>
        $('#goali').click(function () {
           var money= $('#totalPrice').text();

           window.location.href="/goAlipay?money="+money
        })
    </script>
</html>
